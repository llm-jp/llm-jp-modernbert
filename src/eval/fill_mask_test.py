from transformers import AutoTokenizer, AutoModelForMaskedLM
import torch
from argparse import ArgumentParser


def fill_mask(text, model, tokenizer, device):
    inputs = tokenizer(text, return_tensors="pt", padding=True, truncation=True).to(
        device
    )
    outputs = model(**inputs)
    masked_index = inputs["input_ids"][0].tolist().index(tokenizer.mask_token_id)
    predicted_token_id = outputs.logits[0, masked_index].argmax(axis=-1)
    predicted_token = tokenizer.decode(predicted_token_id)
    return predicted_token


EXAMPLE_TEXTS = [
    "日本の首都は{mask_str}であり、多くの観光名所や企業が集まる日本の政治・経済・文化の中心地です。",
    "私は{mask_str}が好きで、週末にはよくそれに関するイベントに参加したり、新しい情報を調べたりしています。",
    "{mask_str}は、日本の首都であり、世界でも有数の人口を誇る大都市として多くの観光客が訪れます。",
    "昨日の夜ご飯は{mask_str}でした。家庭的な味がして、とても美味しかったのでまた作ってみようと思います。",
    "私の趣味は{mask_str}をすることです。毎週末に時間を作って、技術を磨きながら楽しんでいます。",
    "この問題の答えは{mask_str}です。しっかりと考えれば誰でも解けるので、もう一度チャレンジしてみてください。",
    "有名な観光地として{mask_str}が挙げられます。美しい風景や歴史的な建造物が多くの人々を魅了しています。",
    "この映画の主人公は{mask_str}という名前です。彼の成長や冒険が描かれており、多くの人々に感動を与えました。",
    "{mask_str}は、世界的に有名な作曲家であり、その作品は今もなお多くの人々に愛され続けています。",
    "{mask_str}は、スポーツの一種で、世界中で多くのファンがいます。競技人口も多く、大会が頻繁に開催されます。",
    "彼の夢は{mask_str}になることです。子供の頃からの憧れで、毎日努力を続けながら目標に向かっています。",
    "明日の天気は{mask_str}らしいです。外出の予定があるので、服装や持ち物をしっかり準備しようと思います。",
    "{mask_str}は、地球上で最も高い山として知られ、世界中の登山家たちの憧れの地となっています。",
    "この小説の作者は{mask_str}です。彼の作品は独特の文体と深いテーマ性で多くの読者を魅了しています。",
    "次のオリンピックは{mask_str}で開催されます。世界中のアスリートが集まり、白熱した競技が繰り広げられるでしょう。",
    "人気のプログラミング言語の一つに{mask_str}があります。開発の現場で広く使われ、多くのアプリケーションを支えています。",
    "{mask_str}は、歴史上の重要な出来事であり、多くの人々の生活や社会のあり方に大きな影響を与えました。",
    "この動物は{mask_str}と呼ばれています。その特徴的な姿や生態が、多くの研究者や愛好家の関心を引いています。",
    "人類が初めて月に降り立ったのは{mask_str}年です。その歴史的瞬間は世界中の人々に感動を与えました。",
    "最も長い川は{mask_str}です。その流域には多くの都市や村が広がり、豊かな自然や文化が育まれています。",
    "{mask_str}は、代表的な和食の一つです。伝統的な調理法で作られ、日本国内外で多くの人々に親しまれています。",
    "この会社の創業者は{mask_str}です。彼の革新的なアイデアと努力によって、世界的に有名な企業へと成長しました。",
    "彼の出身地は{mask_str}です。幼少期を過ごしたその場所が、彼の価値観や考え方に大きな影響を与えたそうです。",
    "日本の伝統芸能の一つに{mask_str}があります。長い歴史を持ち、現在でも多くの人々に親しまれています。",
    "{mask_str}は、世界遺産に登録されています。その美しい景観や歴史的価値が、多くの観光客を惹きつけています。",
    "世界で最も面積の広い国は{mask_str}です。",
    "桜の名所として有名な公園は{mask_str}です。",
    "{mask_str}は、日本の伝統的な料理の一つです。",
    "日本の通貨単位は{mask_str}です。",
    "1年は{mask_str}ヶ月です。",
    "地球は{mask_str}の周りを公転しています。",
    "光の速さはおよそ{mask_str} km/sです。",
    "英語で「ありがとう」は{mask_str}と言います。",
    "{mask_str}は、太陽系で最も大きな惑星です。",
    "{mask_str} is the capital of Japan.",
    "I like {mask_str} because it's fun and challenging.",
    "水が0℃で{mask_str}します。",
    "オリンピックは{mask_str}年ごとに開催されます。",
    "桜の名所として有名な公園は{mask_str}です。春になると、公園内の桜の木々が一斉に開花し、多くの人々が花見を楽しむために訪れます。桜の開花時期は地域によって異なりますが、この公園では例年、満開の桜を背景に写真を撮ったり、家族や友人と一緒にお弁当を広げたりする姿が見られます。夜にはライトアップが行われ、昼間とは異なる幻想的な景色が広がります。また、桜だけでなく、公園内にはさまざまな植物や歴史的な建造物もあり、年間を通じて観光客が訪れる人気のスポットとなっています。その美しい風景は、国内外のメディアでもたびたび取り上げられています。",
    "この映画の主人公は{mask_str}という名前です。彼は幼い頃から冒険心旺盛で、自然や動物たちとのふれあいを通じて成長していきます。",
    "日本の経済は{mask_str}と言われています。その理由は、多くの企業が世界的な競争力を持ち、新しい技術や製品を生み出しているからです。",
    "彼の夢は{mask_str}になることです。そのためには、まずは基礎からしっかりと学び、実践を重ねていくことが大切です。",
    "この小説の作者は{mask_str}です。彼は独自の世界観を持ち、読者を魅了するストーリー展開が特徴です。",
    "本論文では、{mask_str}についての新しい研究成果を報告します。これまでの研究とは異なる視点から、その重要性や意義を論じていきます。",
    "人間の脳は未解明な部分が多いですが、{mask_str}がその一端を解明する手がかりとなるかもしれません。",
    "ハワイ諸島は日本から{mask_str} kmほど離れています。そのため、日本からハワイへの旅行は比較的短い時間で到着することができます。",
    "彼は試合中に{mask_str}な判断を下し、チームを勝利に導いた",
    "彼は大学時代、心理学を専攻していた。その知識を活かし、現在は{mask_str}として働いている。",
    "彼は日本で生まれ、幼少期を日本で過ごした。その後、アメリカに留学し、{mask_str}を取得した。",
    "A君はB君よりも背が高く、B君はC君よりも背が高い。最も背の低いのは{mask_str}である。",
    "彼は昨晩お酒を飲みすぎた。その結果、今朝は{mask_str}",
    "昨日、図書館に行ったらとても静かだった。{mask_str}のおかげで集中できた。",
    "この映画は、演出、脚本、演技のすべてが非の打ちどころがない。{mask_str}と言っても過言ではない。",
    "彼女は新しいアルバムを作るために曲を{mask_str}いる",
    "吾輩は{mask_str}である。名前はまだ無い。",
    "1年はおよそ{mask_str}日です。",
    "彼は数学のテストで0点を取った。先生は『君は本当に{mask_str}』と言った。",
    "飛行機が着陸すると同時に、彼は{mask_str}を始めた。",
    "濡れ手に{mask_str}。",
    "棚から{mask_str}。",
    "俺は高校生探偵、工藤新一。幼馴染で同級生の毛利蘭と遊園地へ遊びに行って黒ずくめの男の怪しげな取引現場を目撃した。取引を見るのに夢中になっていた俺は、背後から近づいてくるもう一人の仲間に気づかなかった。俺はその男に毒薬を飲まされ、目が覚めたら・・・体が縮んでしまっていた。工藤新一が生きているとやつらにばれたらまた命を狙われ、周りの人間にも危害が及ぶ。阿笠博士の助言で正体を隠すことにした俺は、蘭に名前を聞かれて、とっさに江戸川コナンと名乗り、やつらの情報をつかむ為に、父親が探偵をやっている蘭の家に転がり込んだ。たった一つの真実見抜く見た目は子供、頭脳は大人、その名は、名探偵{mask_str}。",
    "私はその人を常に{mask_str}と呼んでいた。だからここでもただ先生と書くだけで本名は打ち明けない。これは世間を憚かる遠慮というよりも、その方が私にとって自然だからである。私はその人の記憶を呼び起すごとに、すぐ「先生」といいたくなる。筆を執っても心持は同じ事である。よそよそしい頭文字などはとても使う気にならない。私が先生と知り合いになったのは鎌倉である。その時私はまだ若々しい書生であった。暑中休暇を利用して海水浴に行った友達からぜひ来いという端書を受け取ったので、私は多少の金を工面して、出掛ける事にした。私は金の工面に二、三日を費やした。ところが私が鎌倉に着いて三日と経たないうちに、私を呼び寄せた友達は、急に国元から帰れという電報を受け取った。電報には母が病気だからと断ってあったけれども友達はそれを信じなかった。友達はかねてから国元にいる親たちに勧まない結婚を強いられていた。彼は現代の習慣からいうと結婚するにはあまり年が若過ぎた。それに肝心の当人が気に入らなかった。それで夏休みに当然帰るべきところを、わざと避けて東京の近くで遊んでいたのである。彼は電報を私に見せてどうしようと相談をした。私にはどうしていいか分らなかった。けれども実際彼の母が病気であるとすれば彼は固より帰るべきはずであった。それで彼はとうとう帰る事になった。せっかく来た私は一人取り残された。",
    "私は、その男の写真を三葉、見たことがある。一葉は、その男の、幼年時代、とでも言うべきであろうか、十歳前後かと推定される頃の写真であって、その子供が大勢の女のひとに取りかこまれ、（それは、その子供の姉たち、妹たち、それから、従姉妹たちかと想像される）庭園の池のほとりに、荒い縞の袴をはいて立ち、首を三十度ほど左に傾け、醜く笑っている写真である。醜く？けれども、鈍い人たち（つまり、美醜などに関心を持たぬ人たち）は、面白くも何とも無いような顔をして、「可愛い坊ちゃんですね」といい加減なお世辞を言っても、まんざら空お世辞に聞えないくらいの、謂わば通俗の「可愛らしさ」みたいな影もその子供の笑顔に無いわけではないのだが、しかし、いささかでも、美醜に就いての訓練を経て来たひとなら、ひとめ見てすぐ、「なんて、いやな子供だ」と頗る不快そうに呟き、毛虫でも払いのける時のような手つきで、その写真をほうり投げるかも知れない。まったく、その子供の笑顔は、よく見れば見るほど、何とも知れず、イヤな薄気味悪いものが感ぜられて来る。どだい、それは、笑顔でない。この子は、少しも笑ってはいないのだ。その証拠には、この子は、両方のこぶしを固く握って立っている。人間は、こぶしを固く握りながら笑えるものでは無いのである。猿だ。{mask_str}の笑顔だ。ただ、顔に醜い皺を寄せているだけなのである。「皺くちゃ坊ちゃん」とでも言いたくなるくらいの、まことに奇妙な、そうして、どこかけがらわしく、へんにひとをムカムカさせる表情の写真であった。私はこれまで、こんな不思議な表情の子供を見た事が、いちども無かった。",
    "吾輩は猫である。名前はまだ無い。どこで生れたかとんと見当がつかぬ。何でも薄暗いじめじめした所でニャーニャー泣いていた事だけは記憶している。吾輩はここで始めて人間というものを見た。しかもあとで聞くとそれは書生という人間中で一番獰悪な種族であったそうだ。この書生というのは時々我々を捕えて煮て食うという話である。しかしその当時は何という考もなかったから別段恐しいとも思わなかった。ただ彼の掌に載せられてスーと持ち上げられた時何だかフワフワした感じがあったばかりである。掌の上で少し落ちついて書生の顔を見たのがいわゆる人間というものの見始であろう。この時妙なものだと思った感じが今でも残っている。第一毛をもって装飾されべきはずの顔がつるつるしてまるで薬缶だ。その後猫にもだいぶ逢ったがこんな片輪には一度も出会わした事がない。のみならず顔の真中があまりに突起している。そうしてその穴の中から時々ぷうぷうと煙を吹く。どうも咽せぽくて実に弱った。これが人間の飲む{mask_str}というものである事はようやくこの頃知った。この書生の掌の裏でしばらくはよい心持に坐っておったが、しばらくすると非常な速力で運転し始めた。書生が動くのか自分だけが動くのか分らないが無暗に眼が廻る。胸が悪くなる。到底助からないと思っていると、どさりと音がして眼から火が出た。それまでは記憶しているがあとは何の事やらいくら考え出そうとしても分らない。",
    "ある日の暮方の事である。一人の下人が、{mask_str}の下で雨やみを待っていた。広い門の下には、この男のほかに誰もいない。ただ、所々丹塗の剥げた、大きな円柱に、蟋蟀が一匹とまっている。羅生門が、朱雀大路にある以上は、この男のほかにも、雨やみをする市女笠や揉烏帽子が、もう二三人はありそうなものである。それが、この男のほかには誰もいない。何故かと云うと、この二三年、京都には、地震とか辻風とか火事とか饑饉とか云う災がつづいて起った。そこで洛中のさびれ方は一通りではない。旧記によると、仏像や仏具を打砕いて、その丹がついたり、金銀の箔がついたりした木を、路ばたにつみ重ねて、薪の料に売っていたと云う事である。洛中がその始末であるから、羅生門の修理などは、元より誰も捨てて顧る者がなかった。するとその荒れ果てたのをよい事にして、狐狸が棲む。盗人が棲む。とうとうしまいには、引取り手のない死人を、この門へ持って来て、棄てて行くと云う習慣さえ出来た。そこで、日の目が見えなくなると、誰でも気味を悪るがって、この門の近所へは足ぶみをしない事になってしまったのである。その代りまた鴉がどこからか、たくさん集って来た。昼間見ると、その鴉が何羽となく輪を描いて、高い鴟尾のまわりを啼きながら、飛びまわっている。ことに門の上の空が、夕焼けであかくなる時には、それが胡麻をまいたようにはっきり見えた。鴉は、勿論、門の上にある死人の肉を、啄みに来るのである。――もっとも今日は、刻限が遅いせいか、一羽も見えない。ただ、所々、崩れかかった、そうしてその崩れ目に長い草のはえた石段の上に、鴉の糞が、点々と白くこびりついているのが見える。下人は七段ある石段の一番上の段に、洗いざらした紺の襖の尻を据えて、右の頬に出来た、大きな面皰を気にしながら、ぼんやり、雨のふるのを眺めていた。",
    "「ではみなさんは、そういうふうに川だと云われたり、乳の流れたあとだと云われたりしていたこのぼんやりと白いものがほんとうは何かご承知ですか。」先生は、黒板に吊した大きな黒い星座の図の、上から下へ白くけぶった銀河帯のようなところを指しながら、みんなに問をかけました。カムパネルラが手をあげました。それから四五人手をあげました。ジョバンニも手をあげようとして、急いでそのままやめました。たしかにあれがみんな星だと、いつか雑誌で読んだのでしたが、このごろはジョバンニはまるで毎日教室でもねむく、本を読むひまも読む本もないので、なんだかどんなこともよくわからないという気持ちがするのでした。ところが先生は早くもそれを見附けたのでした。「ジョバンニさん。あなたはわかっているのでしょう。」ジョバンニは勢よく立ちあがりましたが、立って見るともうはっきりとそれを答えることができないのでした。ザネリが前の席からふりかえって、{mask_str}を見てくすっとわらいました。ジョバンニはもうどぎまぎしてまっ赤になってしまいました。先生がまた云いました。",
    "メロスは激怒した。必ず、かの邪智暴虐の王を除かなければならぬと決意した。メロスには政治がわからぬ。メロスは、村の牧人である。笛を吹き、羊と遊んで暮して来た。けれども邪悪に対しては、人一倍に敏感であった。きょう未明メロスは村を出発し、野を越え山越え、十里はなれた此のシラクスの市にやって来た。メロスには父も、母も無い。女房も無い。十六の、内気な妹と二人暮しだ。この妹は、村の或る律気な一牧人を、近々、花婿として迎える事になっていた。結婚式も間近かなのである。メロスは、それゆえ、花嫁の衣裳やら祝宴の御馳走やらを買いに、はるばる市にやって来たのだ。先ず、その品々を買い集め、それから都の大路をぶらぶら歩いた。メロスには竹馬の友があった。セリヌンティウスである。今は此のシラクスの市で、石工をしている。その友を、これから訪ねてみるつもりなのだ。久しく逢わなかったのだから、訪ねて行くのが楽しみである。歩いているうちにメロスは、まちの様子を怪しく思った。ひっそりしている。もう既に日も落ちて、まちの暗いのは当りまえだが、けれども、なんだか、夜のせいばかりでは無く、市全体が、やけに寂しい。のんきなメロスも、だんだん不安になって来た。路で逢った若い衆をつかまえて、何かあったのか、二年まえに此の市に来たときは、夜でも皆が歌をうたって、まちは賑やかであった筈だが、と質問した。若い衆は、首を振って答えなかった。しばらく歩いて老爺に逢い、こんどはもっと、語勢を強くして質問した。{mask_str}は答えなかった。メロスは両手で老爺のからだをゆすぶって質問を重ねた。老爺は、あたりをはばかる低声で、わずか答えた。",
    "親譲りの無鉄砲で小供の時から損ばかりしている。小学校に居る時分学校の二階から飛び降りて一週間ほど腰を抜かした事がある。なぜそんな無闇をしたと聞く人があるかも知れぬ。別段深い理由でもない。新築の二階から首を出していたら、同級生の一人が冗談に、いくら威張っても、そこから飛び降りる事は出来まい。弱虫やーい。と囃したからである。小使に負ぶさって帰って来た時、おやじが大きな眼をして二階ぐらいから飛び降りて腰を抜かす奴があるかと云ったから、この次は抜かさずに飛んで見せますと答えた。親類のものから西洋製のナイフを貰って奇麗な刃を日に翳して、友達に見せていたら、一人が光る事は光るが切れそうもないと云った。切れぬ事があるか、何でも切ってみせると受け合った。そんなら君の指を切ってみろと注文したから、何だ指ぐらいこの通りだと右の手の親指の甲をはすに切り込んだ。幸ナイフが小さいのと、親指の骨が堅かったので、今だに親指は手に付いている。しかし{mask_str}は死ぬまで消えぬ。",
    "その日私はいつになくその店で買物をした。というのはその店には珍しい{mask_str}が出ていたのだ。檸檬などごくありふれている。がその店というのも見すぼらしくはないまでもただあたりまえの八百屋に過ぎなかったので、それまであまり見かけたことはなかった。いったい私はあの檸檬が好きだ。レモンエロウの絵具をチューブから搾り出して固めたようなあの単純な色も、それからあの丈の詰まった紡錘形の恰好も。――結局私はそれを一つだけ買うことにした。それからの私はどこへどう歩いたのだろう。私は長い間街を歩いていた。始終私の心を圧えつけていた不吉な塊がそれを握った瞬間からいくらか弛んで来たとみえて、私は街の上で非常に幸福であった。あんなに執拗かった憂鬱が、そんなものの一顆で紛らされる――あるいは不審なことが、逆説的なほんとうであった。それにしても心というやつはなんという不可思議なやつだろう。",
    "どの天皇様の御代であったか、{mask_str}とか更衣とかいわれる後宮がおおぜいいた中に、最上の貴族出身ではないが深い御愛寵を得ている人があった。最初から自分こそはという自信と、親兄弟の勢力に恃む所があって宮中にはいった女御たちからは失敬な女としてねたまれた。その人と同等、もしくはそれより地位の低い更衣たちはまして嫉妬の焔を燃やさないわけもなかった。夜の御殿の宿直所から退る朝、続いてその人ばかりが召される夜、目に見耳に聞いて口惜しがらせた恨みのせいもあったかからだが弱くなって、心細くなった更衣は多く実家へ下がっていがちということになると、いよいよ帝はこの人にばかり心をお引かれになるという御様子で、人が何と批評をしようともそれに御遠慮などというものがおできにならない。御聖徳を伝える歴史の上にも暗い影の一所残るようなことにもなりかねない状態になった。高官たちも殿上役人たちも困って、御覚醒になるのを期しながら、当分は見ぬ顔をしていたいという態度をとるほどの御寵愛ぶりであった。唐の国でもこの種類の寵姫、楊家の女の出現によって乱が醸されたなどと蔭ではいわれる。今やこの女性が一天下の煩いだとされるに至った。馬嵬の駅がいつ再現されるかもしれぬ。その人にとっては堪えがたいような苦しい雰囲気の中でも、ただ深い御愛情だけをたよりにして暮らしていた。父の大納言はもう故人であった。母の未亡人が生まれのよい見識のある女で、わが娘を現代に勢力のある派手な家の娘たちにひけをとらせないよき保護者たりえた。それでも大官の後援者を持たぬ更衣は、何かの場合にいつも心細い思いをするようだった。",
    "高瀬舟は京都の高瀬川を上下する{mask_str}である。徳川時代に京都の罪人が遠島を申し渡されると、本人の親類が牢屋敷へ呼び出されて、そこで暇乞いをすることを許された。それから罪人は高瀬舟に載せられて、大阪へ回されることであった。それを護送するのは、京都町奉行の配下にいる同心で、この同心は罪人の親類の中で、おも立った一人を大阪まで同船させることを許す慣例であった。これは上へ通った事ではないが、いわゆる大目に見るのであった、黙許であった。当時遠島を申し渡された罪人は、もちろん重い科を犯したものと認められた人ではあるが、決して盗みをするために、人を殺し火を放ったというような、獰悪な人物が多数を占めていたわけではない。高瀬舟に乗る罪人の過半は、いわゆる心得違いのために、思わぬ科を犯した人であった。有りふれた例をあげてみれば、当時相対死と言った情死をはかって、相手の女を殺して、自分だけ生き残った男というような類である。そういう罪人を載せて、入相の鐘の鳴るころにこぎ出された高瀬舟は、黒ずんだ京都の町の家々を両岸に見つつ、東へ走って、加茂川を横ぎって下るのであった。この舟の中で、罪人とその親類の者とは夜どおし身の上を語り合う。いつもいつも悔やんでも返らぬ繰り言である。護送の役をする同心は、そばでそれを聞いて、罪人を出した親戚眷族の悲惨な境遇を細かに知ることができた。所詮町奉行の白州で、表向きの口供を聞いたり、役所の机の上で、口書を読んだりする役人の夢にもうかがうことのできぬ境遇である。",
    "七月の初め、方図もなく暑い時分の夕方近く、一人の{mask_str}が、借家人からまた借りしているＳ横町の小部屋から通りへ出て、なんとなく思い切り悪そうにのろのろと、Ｋ橋の方へ足を向けた。青年はうまく階段でおかみと出くわさないで済んだ。彼の小部屋は、高い五階建の屋根裏にあって、住まいというよりむしろ戸棚に近かった。女中と賄いつきで彼にこの部屋を貸していた下宿のおかみは、一階下の別のアパートに住んでいたので、通りへ出ようと思うと、たいていいつも階段に向かっていっぱいあけっ放しになっているおかみの台所わきを、いやでも通らなければならなかった。そしてそのつど、青年はそばを通り過ぎながら、一種病的な臆病な気持を感じた。彼は自分でもその気持を恥じて、顔をしかめるのであった。下宿の借金がかさんでいたので、おかみと顔を合わすのがこわかったのである。もっとも、彼はそれほど臆病で、いじけ切っていたわけでなく、むしろその反対なくらいだった。が、いつのころからか、ヒポコンデリイに類したいら立たしい、張りつめた気分になっていた。すっかり自分というものの中に閉じこもり、すべての人から遠ざかっていたので、下宿のおかみのみならず、いっさい人に会うのを恐れていたのである。彼は貧乏におしひしがれていた。けれども、この逼迫した状態すらも、このごろ彼はあまり苦にしなくなった。その日その日の当面の仕事も全然放擲してしまい、そんな事にかかずらう気にもならなかったのである。彼は正直なところ、どこのどのようなおかみがいかなる事を企てようと、けっして恐れなどしなかった。けれど、階段の上に立ち止まらされて、なんの役にも立たない平凡なごみごみした話や、うるさい払いの督促や、おどかしや、泣き言などを聞かされた上、自分の方でもごまかしたり、あやまったり、嘘をついたりするよりは――猫のように階段をすべりおりて、誰にも見られないように、ちょろりと姿をくらます方がまだしもなのであった。とはいえ、今度は通りへ出てしまうと、借りのある女に会うのをかくまで恐れているということが、われながらぎょっとするほど彼を驚かした。",
    "アレクセイ・フョードロヴィッチ・カラマゾフは、この郡の地主フョードル・パーヴロヴィッチ・カラマゾフの三男で、父のフョードルは、今からちょうど十三年前に悲劇的な陰惨な最後を遂げたために、そのころ（いや、今でもやはりこちらでは時おり噂にのぼる）非常に評判の高かった人物であるが、この事件についてはいずれしかるべきところにおいてお話しすることにしよう。ここでは単にこの『{mask_str}』が（当地では彼のことをこう呼んでいたが、その実、彼は一生涯ほとんど自分の持ち村で暮らしたことがなかった）かなりちょいちょい見受けるには見受けるが、一風変わった型の人間であった、というだけにとどめておこう。つまり、やくざで放埒なばかりではなく、それと同時にわけのわからない人間のタイプ――もっとも、同じわけのわからない連中の中でも、自分の財産に関する細々した事務を、巧みに処理することができて、しかも、それだけが身上かと思われるようなたぐいの人間であった。たとえば、フョードル・パーヴロヴィッチはほとんど無一物で世間へ出て、地主とはいってもきわめてささやかなものなので、よその家へ行って食事をしたり、居候に転がりこむことばかり狙っていたが、死んだ時には現金で十万ルーブルものこしていたことがわかった。それだのに、彼は依然として、一生涯を、郡内きっての最もわからずやの狂気じみた男の一人として押し通してしまったのである。くり返していうが、けっしてばかであったというわけではない。かえって、こういう狂気じみた人間の大多数は、かなり利口で狡猾である、――つまり、わけがわからないのである。しかも、そこにはなんとなく独特な国民的なところさえうかがわれる。",
]


def parse_args():
    parser = ArgumentParser()
    parser.add_argument(
        "--model_list",
        type=str,
        nargs="+",
        default=[
            "cl-tohoku/bert-base-japanese-v3",
            "sbintuitions/modernbert-ja-130m",
            "llm-jp/llm-jp-modernbert-base",
        ],
    )
    parser.add_argument("--text", type=str, default="吾輩は{mask_str}である。")
    return parser.parse_args()


if __name__ == "__main__":
    args = parse_args()
    device = "cuda" if torch.cuda.is_available() else "cpu"

    answers_per_model = {}

    for model_id in args.model_list:
        model = (
            AutoModelForMaskedLM.from_pretrained(model_id, trust_remote_code=True)
            .eval()
            .to(device)
        )
        tokenizer = AutoTokenizer.from_pretrained(model_id, trust_remote_code=True)
        mask_str = tokenizer.mask_token
        if args.text:
            text_list = [args.text]
        else:
            text_list = EXAMPLE_TEXTS
        for text in text_list:
            text = text.format(mask_str=mask_str)
            predicted = fill_mask(text, model, tokenizer, device)
            answers_per_model.setdefault(model_id, []).append(predicted)

    for i, text in enumerate(text_list):
        print(f"Question: {text}")
        for model_id, answers in answers_per_model.items():
            print(f"{model_id}: {answers[i]}", end=", ")
        print("\n")
